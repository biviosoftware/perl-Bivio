#
# Creates a new user, logs them in (registers info in testsuite), creates
# one club instantly, other by going back to clubs page.
#

# Variables:
# Make a diff. club and user ID each time, just in case it runs halfway and
# doesn't delete.

my($club_id) = 'temp_'. int(rand 1000).'_test';
my($user_id) = 'temp_'. int(rand 1000).'_user';
my($passwd) = 'password';


# Make a new user

Browser->go_uri('/pub/register');
Browser->submit({
     'Your Name:' => 'Temporary BTF User',
     'Email:' => 'ignore-'.$user_id.'@test.bivio.com',
     'User ID:' => $user_id,
     'Password:' => $passwd,
     'Confirm:' => $passwd,
     }, 'Register');

# Login is user just registered as...this allows testsuite to store relevant
# info as if had just performed a login.

Login->execute($user_id, $passwd);
 
# Create club

Imagemenu->go_section('Clubs', 'my-site');
Verify->uri('clubs');
Browser->click('create_club_a');
Verify->uri('create-club');
Browser->submit({
     'Club Name:' => 'Temporary BTF Club',
     'Club ID:' => $club_id,
     }, 'Create');
#Verify->uri('new');
Verify->title('Congratulations');

# Visit a page in this new club, for kicks...

Imagemenu->go_section('Administration', $club_id);
Verify->uri('admin');

# Delete the club

Manager->delete_club($club_id);

# Delete the user     

Manager->delete_user($user_id);