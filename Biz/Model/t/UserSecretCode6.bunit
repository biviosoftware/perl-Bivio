# Copyright (c) 2025 bivio Software, Inc.  All Rights Reserved.
Unit();
my($u) = create_user(random_realm_name());
my($objects) = {};
foreach my $x (
    [Type_SecretCode()->LOGIN_CHALLENGE => Type_SecretCodeStatus()->PENDING],
    [Type_SecretCode()->ESCALATION_CHALLENGE => Type_SecretCodeStatus()->PENDING],
    [Type_SecretCode()->MFA_RECOVERY => Type_SecretCodeStatus()->ACTIVE],
    [Type_SecretCode()->PASSWORD_QUERY => Type_SecretCodeStatus()->ACTIVE],
) {
    my($type, $status) = @$x;
    $objects->{$type->get_name} = class()->new(req())->create({type => $type, status => $status});
}
my($bad_statuses) = {
    LOGIN_CHALLENGE => Type_SecretCodeStatus()->ACTIVE,
    ESCALATION_CHALLENGE => Type_SecretCodeStatus()->ACTIVE,
    MFA_RECOVERY => Type_SecretCodeStatus()->PASSED,
    PASSWORD_QUERY => Type_SecretCodeStatus()->PASSED,
};
[
    map({
        my($t) = $_;
        sub {$objects->{$t->get_name}} => [
            update => [
                [{status => $bad_statuses->{$t->get_name}}] => DIE(),
            ],
        ],
    } Type_SecretCode()->get_non_zero_list),
];
