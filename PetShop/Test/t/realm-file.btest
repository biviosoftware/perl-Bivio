# Copyright (c) 2005 bivio Software, Inc.  All Rights Reserved.
# $Id$
test_setup('PetShop');
home_page();
visit_uri('/btest_read/public-file/file.txt');
verify_content_type('text/plain');
verify_text('text/plain');
test_deviance();
visit_uri('/btest_read/public-file/private/file.html');
visit_uri('/btest_read/private/file.html');
test_conformance();
home_page();
login_as('btest_read');
visit_uri('/btest_read/file/private/file.html');
verify_content_type('text/html');
verify_text('text/html');
visit_uri('/btest_read/file/private/image.gif');
verify_content_type('image/gif');
home_page();
login_as('root');
visit_uri('/fourem/file');

if (get_content() =~ m,"/fourem/file/realm-file-btest.txt",) {
    follow_link_in_table('Name', 'Name', 'realm-file-btest.txt',
	'', 'Change');
    fixup_files_uri('DELETE');
    submit_form(OK => {
	'Comments:' => 'deleted by acceptance test',
    });
}

follow_link_in_table('Name', 'Name', '/', '', 'Change');
fixup_files_uri('TEXT_FILE'),
submit_form(OK => {
    'Name:' => 'realm-file-btest.txt',
    _anon => my $c = random_string(),
    'Comments:' => 'x',
});
follow_link('realm-file-btest.txt');
verify_text($c);
