# Copyright (c) 2005 bivio Software, Inc.  All Rights Reserved.
# $Id$
test_setup('PetShop');
home_page();
my($x) = absolute_uri('/demo/dav/pub2');
my($forbidden) = sub {
};
test_deviance(qr{authorization}i);
send_request(OPTIONS => '/demo/dav');
test_conformance();
basic_authorization('guest');
visit_uri('/demo/dav/private/file.html');
send_request(PROPFIND => '/demo/dav/private');
my($rand) = random_string();
test_deviance(qr{forbidden}i);
send_request(MKCOL => "/demo/dav/pub/dav-permission.$rand");
send_request(PUT => "/demo/dav/pub/dav-permission.$rand", undef, '');
send_request(DELETE => '/demo/dav/pub/file.txt');
send_request(LOCK => '/demo/dav/pub');
send_request(MOVE => '/demo/dav/pub', {
    Destination => $x,
});
test_conformance();
send_request(OPTIONS => '/demo/dav/private');
visit_uri('/demo/dav/private/file.html');
